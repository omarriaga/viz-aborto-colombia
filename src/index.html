<!doctype html>
<html class="no-js" lang="">

<head>
  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title></title>
  <meta name="description" content="">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <link rel="apple-touch-icon" href="icon.png">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/semantic-ui@2.4.2/dist/semantic.min.css">
  <link rel="stylesheet" href="css/main.css">
</head>

<body>
<!--[if lte IE 9]>
<p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
<![endif]-->
<div class="ui main fluid container" id="contenido">
  <div id="introduction">
    <h1 class="ui center aligned huge header">Abortos en colombia</h1>
    <h4 class="ui center aligned header">Cifras de aborto legal en Colombia (2009 - 2017)</h4>
    <p>
      Desde 2006, el Tribunal Constitucional de Colombia dio paso a la IVE (Interrupción Voluntaria del Embarazo), permitiendo que este procedimiento se pueda llevar a cabo en tres circunstancias; cuando el embarazo pone en peligro la salud o la vida de la madre, cuando el embarazo es el resultado de una violación o incesto, y cuando hay malformaciones del feto que son incompatibles con la vida fuera del útero.
      Esta interrupción es un derecho fundamental que consiste en un procedimiento para terminar conscientemente un embarazo en curso; en muchos países este procedimiento es ilegal, por lo que las mujeres recurren a hacerlo ilegalmente en lugares que no cumplen con las condiciones óptimas de salud, poniendo su salud y su vida en peligro. Así que las mujeres recurren a hacerlo ilegalmente en lugares que no cumplen con las condiciones óptimas de salud, poniendo su salud y su vida en peligro.
    </p>
  </div>

  <div class="ui center aligned piled segment">
    <h3 class="ui header">Número de abortos por año y departamento </h3>
    <div class="dropdown" id="year"><label>Año: </label><select></select></div>
    <div id="chart-1" style="min-height: 400px;"></div>
  </div>
  <div class="ui divider"></div>
  <div class="paragrah">
    <p>En la siguiente visualización se evidencia que el aborto médico natural (espontáneo) ha sido la tipificación más diagnosticada por los centros de salud autorizados para realizar la interrupción del embarazo de forma legal, en cuanto a los abortos inducidos, se puede observar que extracción menstrual ha sido el medio más utilizado para realizar la interrupción del embarazo.</p>
  </div>
  <div class="ui center aligned piled segment">
    <h3 class="ui header">Numero de abortos por año y diagnóstico</h3>
    <div id="chart-2" style="min-height: 400px;"></div>
  </div>
  <div class="ui center aligned piled segment">
    <h3 class="ui header"> </h3>
    <div id="chart-3" class="ui center aligned" style="min-height: 400px;"></div>
  </div>
  <div class="ui divider"></div>
  <div class="ui grid">
    <div class="ui ten wide column">
      <div class="ui center aligned piled segment">
        <div id="chart-4" class="ui center aligned" style="min-height: 400px;"></div>
      </div>
    </div>
    <div class="ui six wide column">
      <div class="paragrah">
        <p>Según los datos obtenidos del Ministerio de Salud, en la siguiente visualización se puede evidenciar que las mujeres que más acudieron a este tipo de procedimientos en los centros de salud están en el rango de edad de 21 a 30 años, y el año en el cual más se realizaron fue en el año 2014 con un total de 9.537 abortos.</p>
        <p>Con esta visualización también se puede evidenciar que las mujeres entre 10 y 20 años presentan una cantidad significativa de abortos realizados para cada uno de los años, siendo en 2014 el pico más alto. Estas cifras son preocupantes y están directamente relacionadas con los embarazos registrados a temprana edad en Colombia, a raíz de estas cifras se han lanzado diferentes campañas con el fin de prevenir estas situaciones, ejemplo de ello es la campaña #YoCuidoMiFuturo realizada por el ICBF y Profamilia lanzada desde el 2015, este tipo de campañas parecen tener efecto en los jóvenes ya que en los últimos años se ha visto una disminución en la cantidad de abortos realizados.</p>
      </div>
    </div>

    <div class="ui six wide column">
      <div class="paragrah">
        <p>En los mismos rangos de edad, a través de la siguiente visualización se puede ver que el aborto espontaneo completo e incompleto en la mayoría de los rangos es el más predominante, sin embargo, solo en el rango de edad de 41 a 50 años se presentaron más casos de aborto por extracción menstrual.</p>
      </div>
    </div>
    <div class="ui ten wide column">
      <div class="ui center aligned piled segment">
        <h3 class="ui header">Tipo de aborto por edad</h3>
        <div class="dropdown" id="rango"><label>Año: </label><select></select></div>
        <div id="chart-5" style="min-height: 400px;"></div>
      </div>
    </div>
  </div>
  <div class="ui divider"></div>
  <div class="ui grid">
    <div class="ui six wide column">
      <h4 class="ui center aligned header">Tipos de aborto legales diagnosticados.</h4>
      <div class="paragrah">
        <p>De acuerdo con los datos suministrados por el Ministerio de Salud, en el periodo de tiempo entre 2009 y 2017, se realizaron abortos tanto espontáneos (ocurre antes de las 20 semanas de embarazo y existen diferentes tipos: completo: expulsión completa del embrión, incompleto: retención de restos), como inducidos (provocados, como extracción menstrual); además se encontraron prácticas de abortos con un diagnóstico de embarazos no deseados. Las cifras en las siguientes visualizaciones:</p>
      </div>
      <div class="ui center aligned piled segment">
        <div class="dropdown" id="type"><label>Año: </label><select></select></div>
        <div id="chart-7" class="ui center aligned" style="min-height: 400px;"></div>
      </div>
    </div>
    <div class="ui ten wide column">
      <div class="ui center aligned piled segment">
        <div class="dropdown" id="year-2"><label>Año: </label><select></select></div>
        <div id="chart-6" class="ui center aligned" style="min-height: 400px;"></div>
      </div>
      <div class="paragrah">
        <p>Al realizar la exploración en la siguiente visualización, se puede observar que en la mayoría de los departamentos el año en que se presentaron más abortos fue en 2014, en algunos casos se evidencia un pico bastante grande respecto a los demás años.</p>
      </div>
    </div>
  </div>
  <div class="ui center aligned piled segment">
    <div class="dropdown" id="department"><label>Año: </label><select></select></div>
    <div id="chart-8" class="ui center aligned" style="min-height: 400px;"></div>
  </div>
  <br />
  <br />
  <br />
</div>
<script
  src="https://code.jquery.com/jquery-3.1.1.min.js"
  integrity="sha256-hVVnYaiADRTO2PzUGmuLJr8BLUSjGIZsDYGmIJLv2b8="
  crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/semantic-ui@2.4.2/dist/semantic.min.js"></script>
<script src="https://d3js.org/d3.v4.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/vega@4.2.0/build/vega.js"></script>
<script src="https://cdn.jsdelivr.net/npm/vega-lite@3.0.0-rc6/build/vega-lite.js"></script>
<script src="https://cdn.jsdelivr.net/npm/vega-embed@3.19.2/build/vega-embed.js"></script>
<script src="js/plugins.js"></script>
<script src="js/main.js"></script>
<script>
  d3.csv("data.csv", function (d) {
    d.amount = +d.amount;
    return d;
  }, function (error, data) {
    if (error) throw error;
    var barChart = chart("#B40486");
    var nestedData = d3.nest()
      .key(function (d) { return d.year; }).sortKeys(d3.ascending)
      .key(function (d) { return d.college; }).sortKeys(d3.ascending)
      .rollup(function (leaves) { return { "number": leaves.length, "total_amount": d3.sum(leaves, function (d) { return +d.amount; }) } })
      .entries(data);
    var menuYear = d3.select("#year select")
      .on("change", () => change(false));
    menuYear.selectAll("option")
      .data(nestedData)
      .enter().append("option")
      .text(function (d) { return d.key; });
    menuYear.property("value", "2009");
    var change = function (isResize) {
      var year = menuYear.property("value");
      var currentData = nestedData.find(function (d) { return d.key === year }).values
        .map(function (d) { return { key: d.key, value: d.value.total_amount }; })
        .sort(function (a, b) { return b.value - a.value; });
      var selection = d3.select("#chart-1");
      selection.datum(currentData).call(barChart, isResize);
    }
    window.onresize = function () {
      change(true);
    }
    change(false);
  });
  d3.csv("data_6.csv", function (d) {
    d.amount = +d.amount;
    return d;
  }, function (error, data) {
    if (error) throw error;
    var barChart = chart("#AEB404");
    var nestedData = d3.nest()
      .key(function (d) { return d.rango; }).sortKeys(d3.ascending)
      .key(function (d) { return d.college; }).sortKeys(d3.ascending)
      .rollup(function (leaves) { return { "number": leaves.length, "total_amount": d3.sum(leaves, function (d) { return +d.amount; }) } })
      .entries(data);
    var menurango = d3.select("#rango select")
      .on("change", () => change(false));
    menurango.selectAll("option")
      .data(nestedData)
      .enter().append("option")
      .text(function (d) { return d.key; });
    menurango.property("value", "10 a 20 años");
    var change = function (isResize) {
      var rango = menurango.property("value");
      var currentData = nestedData.find(function (d) { return d.key === rango }).values
        .map(function (d) { return { key: d.key, value: d.value.total_amount }; })
        .sort(function (a, b) { return b.value - a.value; });
      var selection = d3.select("#chart-5");
      selection.datum(currentData).call(barChart, isResize);
    }
    window.onresize = function () {
      change(true);
    }
    change(false);
  });
  d3.csv("data_7.csv", function (d) {
    d.amount = +d.amount;
    return d;
  }, function (error, data) {
    if (error) throw error;
    var barChart = chart("#0B610B");
    var nestedData = d3.nest()
      .key(function (d) { return d.year; }).sortKeys(d3.ascending)
      .key(function (d) { return d.college; }).sortKeys(d3.ascending)
      .rollup(function (leaves) { return { "number": leaves.length, "total_amount": d3.sum(leaves, function (d) { return +d.amount; }) } })
      .entries(data);
    var menuYear = d3.select("#year-2 select")
      .on("change", () => change(false));
    menuYear.selectAll("option")
      .data(nestedData)
      .enter().append("option")
      .text(function (d) { return d.key; });
    menuYear.property("value", "2009");
    var change = function (isResize) {
      var year = menuYear.property("value");
      var currentData = nestedData.find(function (d) { return d.key === year }).values
        .map(function (d) { return { key: d.key, value: d.value.total_amount }; })
        .sort(function (a, b) { return b.value - a.value; });
      var selection = d3.select("#chart-6");
      selection.datum(currentData).call(barChart, isResize);
    }
    window.onresize = function () {
      change(true);
    }
    change(false);
  });
  d3.csv("data_8.csv", function (d) {
    d.amount = +d.amount;
    return d;
  }, function (error, data) {
    if (error) throw error;
    var barChart = chart("#088A85");
    var nestedData = d3.nest()
      .key(function (d) { return d.college; }).sortKeys(d3.ascending)
      .key(function (d) { return d.year; }).sortKeys(d3.ascending)
      .rollup(function (leaves) { return { "number": leaves.length, "total_amount": d3.sum(leaves, function (d) { return +d.amount; }) } })
      .entries(data);
    var menuYear = d3.select("#type select")
      .on("change", () => change(false));
    menuYear.selectAll("option")
      .data(nestedData)
      .enter().append("option")
      .text(function (d) { return d.key; });
    menuYear.property("value", "COMPLETO");
    var change = function (isResize) {
      var college = menuYear.property("value");
      var currentData = nestedData.find(function (d) { return d.key === college }).values
        .map(function (d) { return { key: d.key, value: d.value.total_amount }; })
        .sort(function (a, b) { return b.value - a.value; });
      var selection = d3.select("#chart-7");
      selection.datum(currentData).call(barChart, isResize);
    }
    window.onresize = function () {
      change(true);
    }
    change(false);
  });
  d3.csv("data_9.csv", function (d) {
    d.amount = +d.amount;
    return d;
  }, function (error, data) {
    if (error) throw error;
    var barChart = chart("#AEB404");
    var nestedData = d3.nest()
      .key(function (d) { return d.college; }).sortKeys(d3.ascending)
      .key(function (d) { return d.year; }).sortKeys(d3.ascending)
      .rollup(function (leaves) { return { "number": leaves.length, "total_amount": d3.sum(leaves, function (d) { return +d.amount; }) } })
      .entries(data);
    var menuYear = d3.select("#department select")
      .on("change", () => change(false));
    menuYear.selectAll("option")
      .data(nestedData)
      .enter().append("option")
      .text(function (d) { return d.key; });
    menuYear.property("value", "Amazonas");
    var change = function (isResize) {
      var college = menuYear.property("value");
      var currentData = nestedData.find(function (d) { return d.key === college }).values
        .map(function (d) { return { key: d.key, value: d.value.total_amount }; })
        .sort(function (a, b) { return b.value - a.value; });
      var selection = d3.select("#chart-8");
      selection.datum(currentData).call(barChart, isResize);
    }
    window.onresize = function () {
      change(true);
    }
    change(false);
  });
  var chart = function (color) {
    var svg = null;
    var width;
    var height;
    var chartWidth;
    var chartHeight;
    var x;
    var y;
    function chart(selection, isResize) {
      selection.each(function (data) {
        var duration = isResize ? 0 : 1000;
        width = selection.node().getBoundingClientRect().width;
        height = selection.node().getBoundingClientRect().height;
        console.log("height", height);
        var ratio = (width - 200) / (800 - 200);
        var clampedRatio = Math.max(0, Math.min(1, ratio));
        var marginBottom = 80 + 48 * clampedRatio;
        var marginLeft = 48 + 24 * clampedRatio;
        var margin = {
          top: 22,
          right: 10,
          bottom: marginBottom,
          left: marginLeft
        };
        chartWidth = width - margin.left - margin.right;
        chartHeight = height - margin.top - margin.bottom;
        if (!svg) {
          svg = selection.append("svg")
            .style("vertical-align", "bottom")
            .style("height", "100%"); // <-- Makes all the difference
          var g = svg.append("g");
          g.append("g")
            .attr("class", "axis axis--x");
          g.append("g")
            .attr("class", "axis axis--y");
          svg.append("text")
            .attr("class", "label")
            .attr("transform", "rotate(-90)")
            .attr("dy", "0.71em")
            .attr("text-anchor", "middle")
            .text("Total Abortos ");
        }
        svg.attr("height", height)
          .attr("width", width);
        svg.select("g")
          .attr("transform", "translate(" + margin.left + "," + margin.top + ")");
        svg.select(".title")
          .attr("x", width - margin.right);
        svg.select(".label")
          .attr("x", -chartHeight / 2)
          .attr("y", 8);
        d3.select("#year")
          .style("right", margin.right + "px")
          .style("top", (12 + 13.4) + "px");
        d3.select("#quantity")
          .style("right", margin.right + "px")
          .style("top", (margin.top + 50) + "px");
        x = d3.scaleBand().range([0, chartWidth]).padding(0.1);
        y = d3.scaleLinear().rangeRound([chartHeight, 0]);
        x.domain(data.map(function (d) { return d.key; }));
        y.domain([0, d3.max(data, function (d) { return d.value; })]).nice();
        var t = d3.transition()
          .duration(duration);
        var xAxis = svg.select(".axis--x")
          .attr("transform", "translate(0," + chartHeight + ")");
        xAxis.transition()
          .duration(duration)
          .call(d3.axisBottom(x))
          .selectAll("text")
          .attr("y", 0);
        xAxis.selectAll("text")
          .attr("y", 0)
          .attr("x", -5)
          .attr("dy", ".25em")
          .attr("transform", "rotate(-90)")
          .style("text-anchor", "end");
        svg.select(".axis--y")
          .transition(t)
          .delay(duration)
          .call(d3.axisLeft(y).tickSize(-width));
        var bars = svg.select('g')
          .selectAll(".bar")
          .data(data, function (d) { return d.key; });
        bars
          .transition(t)
          .attr("x", function (d) { return x(d.key); })
          .attr("width", x.bandwidth())
          .transition(t)
          .attr("y", function (d) { return y(d.value); })
          .attr("height", function (d) { return chartHeight - y(d.value); })
          .style("fill", function (d) { return color; });
        bars.enter()
          .append("rect")
          .attr("class", "bar")
          .attr("x", function (d) { return x(d.key); })
          .attr("y", function (d) { return y(0); })
          .attr("width", x.bandwidth())
          .style("fill", function (d) { return color; })
          .transition(t)
          .delay(duration)
          .attr("y", function (d) { return y(d.value); })
          .attr("height", function (d) {
            console.log(chartHeight, y(d.value),  chartHeight - y(d.value));
            return chartHeight - y(d.value); });
        bars.exit()
          .attr("opacity", 1)
          .transition(t)
          .attr("y", function (d) { return y(0); })
          .attr("height", function (d) { return 0; })
          .attr("opacity", 0)
          .remove();
      });
    }
    return chart;
  }
  const dataviz8 = d3.select("#chart-2");
  const width = dataviz8.node().getBoundingClientRect().width;
  var vlSpec =
    {
      '$schema': 'https://vega.github.io/schema/vega-lite/v3.json',
      'data': { 'url': 'dataViz8.json'},
      "autosize": {
        "type": "fit",
        "resize": true
      },
      'width': 80,
      'mark': 'bar',
      'encoding': {
        'column': {
          'field': 'AÑO', 'type': 'ordinal'
        },
        'y': {
          'aggregate': 'sum', 'field': 'CANTIDAD', 'type': 'quantitative',
          'axis': {'title': 'CANTIDAD ABORTOS', 'grid': false}
        },
        'x': {
          'field': 'DIAGNÓSTICO', 'type': 'nominal',
          'scale': {'rangeStep': 30},
          'axis': {'title': ''}
        },
        'color': {
          'field': 'DIAGNÓSTICO', 'type': 'nominal',
          'scale': {'range': ['#6B6CCA', '#F48FFF', '#5CC1CA', '#CAC86D', '#41FF17']}
        }
      },
      'config': {
        'view': {'stroke': 'transparent'},
        'axis': {'domainWidth': 5}
      }
    };
  // Embed the visualization in the container with id `vis`
  vegaEmbed('#chart-2', vlSpec,{theme: 'light', actions:false});
  // Assign the specification to a local variable vlSpec.
  var vlSpec3 =
    {
      "$schema": "https://vega.github.io/schema/vega-lite/v3.json",
      "data": {"url": "dataviz3.json"},
      "mark": "bar",
      "width": 500,
      "height": 380,
      "autosize": {
        "type": "fit",
        "resize": true
      },
      "encoding": {
        "x": {
          // "timeUnit": "month",
          "field": "year",
          "type": "ordinal",
          "axis": {"title": "AÑO"}
        },
        "y": {
          "field":"amount",
          "aggregate": "sum",
          "type": "quantitative",
          "axis": {"title": "CANTIDAD"}
        },
        "color": {
          "field": "TIPO ABORTO",
          "type": "nominal",
          "scale":{"scheme":"tableau10"
          },
          "legend": {"title": "TIPO DE ABORTO"}
        }
      }
    }
  // Embed the visualization in the container with id `vis`
  vegaEmbed("#chart-3", vlSpec3,{theme: 'light', actions:false});
  const dataviz4 = d3.select("#chart-4");
  const width4 = dataviz4.node().getBoundingClientRect().width;
  var vlSpec4 =
    {
      "$schema": "https://vega.github.io/schema/vega-lite/v3.0.0-rc6.json",
      "data": {"url": "data4.csv"},
      //"mark": "trail"
      "width": width4,
      "height": 400,
      "autosize": {
        "type": "fit",
        "resize": true
      },
      "layer": [
        {
          "encoding": {
            "x": {"field": "FECHA", "type": "nominal","axis":{"title":"TOTAL AÑO"},},
            "y": {"field": "NUMERO DE ABORTOS", "type": "quantitative","axis":{"title":"NUMERO DE ABORTOS"}},
            "color": {"field": "RANGO DE EDAD", "type": "nominal"}
          },
          "layer": [{
            "mark": "trail"
          },{
            "selection": {
              "tooltip": {
                "type": "single",
                "nearest": true,
                "on": "mouseover",
                "encodings": [
                  "x"
                ],
                "empty": "none"
              }
            },
            "mark": "circle",
            "encoding": {
              "opacity": {
                "condition": {
                  "selection": "tooltip",
                  "value": 1
                },
                "value": 0
              }
            }
          }]
        },
        {
          "transform": [
            {
              "filter": {
                "selection": "tooltip",
                "fontSize": 66
              }
            }
          ],
          "layer": [{
            "mark": {
              "type": "rule",
              "color": "gray",
              "strokeWidth":1
            },
            "encoding": {
              "x": {
                "type": "nominal",
                "field": "FECHA"
              }
            }
          }, {
            "mark": {
              "type": "text",
              "align": "right",
              "baseline":"bottom",
              "fontWeight":"bold",
              "fontSize": 16,
              "font":"sans-serif",
              "dx": 10,
              "dy": -10
            },
            "encoding": {
              "text": {
                "type": "quantitative",
                "field": "NUMERO DE ABORTOS"
              },
              "color": { "type": "nominal","field": "RANGO DE EDAD"},
              "x": {

                "type": "nominal",
                "field": "FECHA",
              },
              "y": {
                "type": "quantitative",
                "field": "NUMERO DE ABORTOS"
              }
            }
          }]
        }
      ]
    }
  // Embed the visualization in the container with id `vis`
  vegaEmbed("#chart-4", vlSpec4,{theme: 'light', actions:false});
</script>
</body>

</html>
